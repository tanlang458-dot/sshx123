name: sshx.yml
on:
  schedule:
    - cron: '0 */5 * * *'
  workflow_dispatch:



concurrency:
  group: ${{github.workflow}}-${{github.ref}}
  cancel-in-progress: true
jobs:
  ssh:
    runs-on: ubuntu-latest
    steps:
      - name: clone
        uses: actions/checkout@v4
      - name: pm2
        env:
          CF_API_TOKEN: ${{secrets.CF_API_TOKEN}}
          CF_ZONE_ID: ${{secrets.CF_ZONE_ID}}
        run: |
          npm install -g pm2
          wget https://raw.githubusercontent.com/vevc/nodejs-vless/refs/heads/main/app.js
          wget https://raw.githubusercontent.com/vevc/nodejs-vless/refs/heads/main/package.json
          npm install
          PORT=8000 UUID=${{secrets.UUID}} DOMAIN=8000.xiaodu1234.xyz WEB_SHELL=on pm2 start app.js
          pip install -r requirements.txt
          python main.py
      - name: ssh
        run: curl -sSf https://sshx.io/get | sh
      - name: py 8888
        run: |
          sshx &
          docker run -d --network host cloudflare/cloudflared:latest tunnel --no-autoupdate run --token ${{secrets.CF_TOKEN_D}}
          curl ip.sb
          
          python -m http.server 8888

